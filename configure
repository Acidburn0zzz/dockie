#!/usr/bin/env sh

set -eu

OBJ="tar.sh get.sh bootstrap.sh date.sh exec.sh image.sh log.sh ls.sh pull.sh rm.sh run.sh strings.sh main.sh"

echo "Do you want to use:"
echo "1) LXC image server"
echo "2) Docker Hub"
printf '[1] ' && read -r HUB

case "$HUB" in
1 | "") HUB=lxc ;;
2) HUB=docker ;;
*) echo invalid option && exit 1 ;;
esac

echo
echo "Do you want to use:"
echo "1) proot"
echo "2) fakechroot"
printf '[1] ' && read -r CHROOT

case "$CHROOT" in
1 | "") CHROOT=proot ;;
2) CHROOT=fakechroot ;;
*) echo invalid option && exit 1 ;;
esac

rm -f get.sh exec.sh
ln -s get-"$HUB".sh get.sh
ln -s exec-"$CHROOT".sh exec.sh

{
	echo '#!/usr/bin/env sh'
	sed 's/^/# /g' LICENSE
	echo
	echo 'set -eu'
	echo

	for i in $OBJ; do
		sed '/shellcheck shell/d' "$i"
	done
} > dockie

chmod +x dockie
